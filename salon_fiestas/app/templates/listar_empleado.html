{% load static %}
<!DOCTYPE html>
<html lang="es" translate="no">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Panel Empleado</title>
    <link rel="stylesheet" href="{% static 'css/stylelistar.css' %}">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
</head>

<body>
    <nav class="navbar navbar-expand-lg bg-body-tertiary">
        <div class="container-fluid">
            <div class="navbar-nav">
                <a class="nav-var">Menucito</a>
                <a class="nav-link" href="{% url 'login' %}">Cerrar Sesión</a>
            </div>
        </div>
    </nav>
    <h1>Reservaciones Asignadas</h1>
    <p class="mensaje-info">Puedes consultar las reservaciones y marcar como “Listo” aquellas que ya se atendieron.</p>

    <table class="tabla-productos">
        <thead>
            <tr>
                <th>Cliente</th>
                <th>Fecha</th>
                <th>Duración</th>
                <th>Invitados</th>
                <th>Tipo</th>
                <th>Teléfono</th>
                <th>Estatus</th>
                <th>Acción</th>
            </tr>
        </thead>
        <tbody>
            {% for reservacion in reservaciones %}
            <tr>
                <td>{{ reservacion.nombre_cliente }}</td>
                <td>{{ reservacion.fecha_evento|date:"Y-m-d H:i" }}</td>
                <td>{{ reservacion.duracion_horas }}</td>
                <td>{{ reservacion.num_invitados }}</td>
                <td>{{ reservacion.tipo_evento }}</td>
                <td>{{ reservacion.telefono_contacto }}</td>
                <td>{{ reservacion.estatus }}</td>
                <td>
                    {% if reservacion.estatus != "LISTO" %}
                    <form method="post" action="{% url 'marcar_listo' reservacion.id %}">
                        {% csrf_token %}
                        <button class="boton-listo" type="submit">Marcar como listo</button>
                    </form>
                    {% else %}
                    <span class="estatus-listo">✔ Listo</span>
                    {% endif %}
                </td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="7" class="text-center text-muted">No hay reservaciones disponibles.</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    <script src="{% static 'js/marcarlisto.js' %}" defer></script>
</body>
</html>